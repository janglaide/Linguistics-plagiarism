union2 <- union(x = tokens2$control_sum, y = tokens_test$control_sum)
intersect2 <- intersect(x = tokens2$control_sum, y = tokens_test$control_sum)
union2 <- length(union2)
intersect2 <- length(intersect2)
r_2 <- as.numeric(intersect2 / union2)
c_2 <- as.numeric(intersect2 / nrow(tokens_test))
union3 <- union(x = tokens3$control_sum, y = tokens_test$control_sum)
intersect3 <- intersect(x = tokens3$control_sum, y = tokens_test$control_sum)
union3 <- length(union3)
intersect3 <- length(intersect3)
r_3 <- as.numeric(intersect3 / union3)
c_3 <- as.numeric(intersect3 / nrow(tokens_test))
union4 <- union(x = tokens4$control_sum, y = tokens_test$control_sum)
intersect4 <- intersect(x = tokens4$control_sum, y = tokens_test$control_sum)
union4 <- length(union4)
intersect4 <- length(intersect4)
r_4 <- as.numeric(intersect4 / union4)
c_4 <- as.numeric(intersect4 / nrow(tokens_test))
union5 <- union(x = tokens5$control_sum, y = tokens_test$control_sum)
intersect5 <- intersect(x = tokens5$control_sum, y = tokens_test$control_sum)
union5 <- length(union5)
intersect5 <- length(intersect5)
r_5 <- as.numeric(intersect5 / union5)
c_5 <- as.numeric(intersect5 / nrow(tokens_test))
union6 <- union(x = tokens6$control_sum, y = tokens_test$control_sum)
intersect6 <- intersect(x = tokens6$control_sum, y = tokens_test$control_sum)
union6 <- length(union6)
intersect6 <- length(intersect6)
r_6 <- as.numeric(intersect6 / union6)
c_6 <- as.numeric(intersect6 / nrow(tokens_test))
sprintf("Match 1: r = %f, c = %f, d = %f", r_1, c_1, as.numeric(1 - r_1))
sprintf("Match 2: r = %f, c = %f, d = %f", r_2, c_2, as.numeric(1 - r_2))
sprintf("Match 3: r = %f, c = %f, d = %f", r_3, c_3, as.numeric(1 - r_3))
sprintf("Match 4: r = %f, c = %f, d = %f", r_4, c_4, as.numeric(1 - r_4))
sprintf("Match 5: r = %f, c = %f, d = %f", r_5, c_5, as.numeric(1 - r_5))
sprintf("Match 6: r = %f, c = %f, d = %f", r_6, c_6, as.numeric(1 - r_6))
tokens_mod_test <- tokenize_ngrams(test4, n = 3)
tokens_mod_test <- data.frame(tokens_mod_test)
colnames(tokens_mod_test)[1] = "shingle"
for(i in 1:nrow(tokens_mod_test)){
line <- as.character(tokens_mod_test$shingle[i])
line <- unlist(strsplit(line, " "))
tokens_mod_test$sorted[i] <- paste(sort(line), collapse = " ")
}
tokens_mod_test <- select(tokens_mod_test, sorted)
tokens_mod_test <- distinct(tokens_mod_test)
for(i in 1:nrow(tokens_mod_test)){
tokens_mod_test$control_sum[i] <- digest(as.character(tokens_mod_test$sorted[i]), "md5", serialize = FALSE)
}
union1_mod <- union(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
intersect1_mod <- intersect(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
union1_mod <- length(union1_mod)
intersect1_mod <- length(intersect1_mod)
r_1_mod <- as.numeric(intersect1_mod / union1_mod)
c_1_mod <- as.numeric(intersect1_mod / nrow(tokens_mod_test))
union2_mod <- union(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
intersect2_mod <- intersect(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
union2_mod <- length(union2_mod)
intersect2_mod <- length(intersect2_mod)
r_2_mod <- as.numeric(intersect2_mod / union2_mod)
c_2_mod <- as.numeric(intersect2_mod / nrow(tokens_mod_test))
union3_mod <- union(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
intersect3_mod <- intersect(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
union3_mod <- length(union3_mod)
intersect3_mod <- length(intersect3_mod)
r_3_mod <- as.numeric(intersect3_mod / union3_mod)
c_3_mod <- as.numeric(intersect3_mod / nrow(tokens_mod_test))
union4_mod <- union(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
intersect4_mod <- intersect(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
union4_mod <- length(union4_mod)
intersect4_mod <- length(intersect4_mod)
r_4_mod <- as.numeric(intersect4_mod / union4_mod)
c_4_mod <- as.numeric(intersect4_mod / nrow(tokens_mod_test))
union5_mod <- union(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
intersect5_mod <- intersect(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
union5_mod <- length(union5_mod)
intersect5_mod <- length(intersect5_mod)
r_5_mod <- as.numeric(intersect5_mod / union5_mod)
c_5_mod <- as.numeric(intersect5_mod / nrow(tokens_mod_test))
union6_mod <- union(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
intersect6_mod <- intersect(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
union6_mod <- length(union6_mod)
intersect6_mod <- length(intersect6_mod)
r_6_mod <- as.numeric(intersect6_mod / union6_mod)
c_6_mod <- as.numeric(intersect6_mod / nrow(tokens_mod_test))
sprintf("Match 1 (modified): r = %f, c = %f, d = %f", r_1_mod, c_1_mod, as.numeric(1 - r_1_mod))
sprintf("Match 2 (modified): r = %f, c = %f, d = %f", r_2_mod, c_2_mod, as.numeric(1 - r_2_mod))
sprintf("Match 3 (modified): r = %f, c = %f, d = %f", r_3_mod, c_3_mod, as.numeric(1 - r_3_mod))
sprintf("Match 4 (modified): r = %f, c = %f, d = %f", r_4_mod, c_4_mod, as.numeric(1 - r_4_mod))
sprintf("Match 5 (modified): r = %f, c = %f, d = %f", r_5_mod, c_5_mod, as.numeric(1 - r_5_mod))
sprintf("Match 6 (modified): r = %f, c = %f, d = %f", r_6_mod, c_6_mod, as.numeric(1 - r_6_mod))
tokens_test <- tokenize_ngrams(test4, n = 3)
tokens_test <- data.frame(tokens_test)
tokens_test <- distinct(tokens_test)
colnames(tokens_test)[1] = "shingle"
for(i in 1:nrow(tokens_test)){
tokens_test$control_sum[i] <- digest(as.character(tokens_test$shingle[i]), "md5", serialize = FALSE)
}
union1 <- union(x = tokens1$control_sum, y = tokens_test$control_sum)
intersect1 <- intersect(x = tokens1$control_sum, y = tokens_test$control_sum)
union1 <- length(union1)
intersect1 <- length(intersect1)
r_1 <- as.numeric(intersect1 / union1)
c_1 <- as.numeric(intersect1 / nrow(tokens_test))
union2 <- union(x = tokens2$control_sum, y = tokens_test$control_sum)
intersect2 <- intersect(x = tokens2$control_sum, y = tokens_test$control_sum)
union2 <- length(union2)
intersect2 <- length(intersect2)
r_2 <- as.numeric(intersect2 / union2)
c_2 <- as.numeric(intersect2 / nrow(tokens_test))
union3 <- union(x = tokens3$control_sum, y = tokens_test$control_sum)
intersect3 <- intersect(x = tokens3$control_sum, y = tokens_test$control_sum)
union3 <- length(union3)
intersect3 <- length(intersect3)
r_3 <- as.numeric(intersect3 / union3)
c_3 <- as.numeric(intersect3 / nrow(tokens_test))
union4 <- union(x = tokens4$control_sum, y = tokens_test$control_sum)
intersect4 <- intersect(x = tokens4$control_sum, y = tokens_test$control_sum)
union4 <- length(union4)
intersect4 <- length(intersect4)
r_4 <- as.numeric(intersect4 / union4)
c_4 <- as.numeric(intersect4 / nrow(tokens_test))
union5 <- union(x = tokens5$control_sum, y = tokens_test$control_sum)
intersect5 <- intersect(x = tokens5$control_sum, y = tokens_test$control_sum)
union5 <- length(union5)
intersect5 <- length(intersect5)
r_5 <- as.numeric(intersect5 / union5)
c_5 <- as.numeric(intersect5 / nrow(tokens_test))
union6 <- union(x = tokens6$control_sum, y = tokens_test$control_sum)
intersect6 <- intersect(x = tokens6$control_sum, y = tokens_test$control_sum)
union6 <- length(union6)
intersect6 <- length(intersect6)
r_6 <- as.numeric(intersect6 / union6)
c_6 <- as.numeric(intersect6 / nrow(tokens_test))
sprintf("Match 1: r = %f, c = %f, d = %f", r_1, c_1, as.numeric(1 - r_1))
sprintf("Match 2: r = %f, c = %f, d = %f", r_2, c_2, as.numeric(1 - r_2))
sprintf("Match 3: r = %f, c = %f, d = %f", r_3, c_3, as.numeric(1 - r_3))
sprintf("Match 4: r = %f, c = %f, d = %f", r_4, c_4, as.numeric(1 - r_4))
sprintf("Match 5: r = %f, c = %f, d = %f", r_5, c_5, as.numeric(1 - r_5))
sprintf("Match 6: r = %f, c = %f, d = %f", r_6, c_6, as.numeric(1 - r_6))
text4 <- read_file(f4)
text5 <- read_file(f5)
text6 <- read_file(f6)
tokens_test <- tokenize_ngrams(test4, n = 3)
tokens_test <- data.frame(tokens_test)
tokens_test <- distinct(tokens_test)
colnames(tokens_test)[1] = "shingle"
for(i in 1:nrow(tokens_test)){
tokens_test$control_sum[i] <- digest(as.character(tokens_test$shingle[i]), "md5", serialize = FALSE)
}
union1 <- union(x = tokens1$control_sum, y = tokens_test$control_sum)
intersect1 <- intersect(x = tokens1$control_sum, y = tokens_test$control_sum)
union1 <- length(union1)
intersect1 <- length(intersect1)
r_1 <- as.numeric(intersect1 / union1)
c_1 <- as.numeric(intersect1 / nrow(tokens_test))
union2 <- union(x = tokens2$control_sum, y = tokens_test$control_sum)
intersect2 <- intersect(x = tokens2$control_sum, y = tokens_test$control_sum)
union2 <- length(union2)
intersect2 <- length(intersect2)
r_2 <- as.numeric(intersect2 / union2)
c_2 <- as.numeric(intersect2 / nrow(tokens_test))
union3 <- union(x = tokens3$control_sum, y = tokens_test$control_sum)
intersect3 <- intersect(x = tokens3$control_sum, y = tokens_test$control_sum)
union3 <- length(union3)
intersect3 <- length(intersect3)
r_3 <- as.numeric(intersect3 / union3)
c_3 <- as.numeric(intersect3 / nrow(tokens_test))
union4 <- union(x = tokens4$control_sum, y = tokens_test$control_sum)
intersect4 <- intersect(x = tokens4$control_sum, y = tokens_test$control_sum)
union4 <- length(union4)
intersect4 <- length(intersect4)
r_4 <- as.numeric(intersect4 / union4)
c_4 <- as.numeric(intersect4 / nrow(tokens_test))
union5 <- union(x = tokens5$control_sum, y = tokens_test$control_sum)
intersect5 <- intersect(x = tokens5$control_sum, y = tokens_test$control_sum)
union5 <- length(union5)
intersect5 <- length(intersect5)
r_5 <- as.numeric(intersect5 / union5)
c_5 <- as.numeric(intersect5 / nrow(tokens_test))
union6 <- union(x = tokens6$control_sum, y = tokens_test$control_sum)
intersect6 <- intersect(x = tokens6$control_sum, y = tokens_test$control_sum)
union6 <- length(union6)
intersect6 <- length(intersect6)
r_6 <- as.numeric(intersect6 / union6)
c_6 <- as.numeric(intersect6 / nrow(tokens_test))
sprintf("Match 1: r = %f, c = %f, d = %f", r_1, c_1, as.numeric(1 - r_1))
sprintf("Match 2: r = %f, c = %f, d = %f", r_2, c_2, as.numeric(1 - r_2))
sprintf("Match 3: r = %f, c = %f, d = %f", r_3, c_3, as.numeric(1 - r_3))
sprintf("Match 4: r = %f, c = %f, d = %f", r_4, c_4, as.numeric(1 - r_4))
sprintf("Match 5: r = %f, c = %f, d = %f", r_5, c_5, as.numeric(1 - r_5))
sprintf("Match 6: r = %f, c = %f, d = %f", r_6, c_6, as.numeric(1 - r_6))
test4 <- read_file(f_test4)
test5 <- read_file(f_test5)
test6 <- read_file(f_test6)
tokens_test <- tokenize_ngrams(test4, n = 3)
tokens_test <- data.frame(tokens_test)
tokens_test <- distinct(tokens_test)
colnames(tokens_test)[1] = "shingle"
for(i in 1:nrow(tokens_test)){
tokens_test$control_sum[i] <- digest(as.character(tokens_test$shingle[i]), "md5", serialize = FALSE)
}
union1 <- union(x = tokens1$control_sum, y = tokens_test$control_sum)
intersect1 <- intersect(x = tokens1$control_sum, y = tokens_test$control_sum)
union1 <- length(union1)
intersect1 <- length(intersect1)
r_1 <- as.numeric(intersect1 / union1)
c_1 <- as.numeric(intersect1 / nrow(tokens_test))
union2 <- union(x = tokens2$control_sum, y = tokens_test$control_sum)
intersect2 <- intersect(x = tokens2$control_sum, y = tokens_test$control_sum)
union2 <- length(union2)
intersect2 <- length(intersect2)
r_2 <- as.numeric(intersect2 / union2)
c_2 <- as.numeric(intersect2 / nrow(tokens_test))
union3 <- union(x = tokens3$control_sum, y = tokens_test$control_sum)
intersect3 <- intersect(x = tokens3$control_sum, y = tokens_test$control_sum)
union3 <- length(union3)
intersect3 <- length(intersect3)
r_3 <- as.numeric(intersect3 / union3)
c_3 <- as.numeric(intersect3 / nrow(tokens_test))
union4 <- union(x = tokens4$control_sum, y = tokens_test$control_sum)
intersect4 <- intersect(x = tokens4$control_sum, y = tokens_test$control_sum)
union4 <- length(union4)
intersect4 <- length(intersect4)
r_4 <- as.numeric(intersect4 / union4)
c_4 <- as.numeric(intersect4 / nrow(tokens_test))
union5 <- union(x = tokens5$control_sum, y = tokens_test$control_sum)
intersect5 <- intersect(x = tokens5$control_sum, y = tokens_test$control_sum)
union5 <- length(union5)
intersect5 <- length(intersect5)
r_5 <- as.numeric(intersect5 / union5)
c_5 <- as.numeric(intersect5 / nrow(tokens_test))
union6 <- union(x = tokens6$control_sum, y = tokens_test$control_sum)
intersect6 <- intersect(x = tokens6$control_sum, y = tokens_test$control_sum)
union6 <- length(union6)
intersect6 <- length(intersect6)
r_6 <- as.numeric(intersect6 / union6)
c_6 <- as.numeric(intersect6 / nrow(tokens_test))
sprintf("Match 1: r = %f, c = %f, d = %f", r_1, c_1, as.numeric(1 - r_1))
sprintf("Match 2: r = %f, c = %f, d = %f", r_2, c_2, as.numeric(1 - r_2))
sprintf("Match 3: r = %f, c = %f, d = %f", r_3, c_3, as.numeric(1 - r_3))
sprintf("Match 4: r = %f, c = %f, d = %f", r_4, c_4, as.numeric(1 - r_4))
sprintf("Match 5: r = %f, c = %f, d = %f", r_5, c_5, as.numeric(1 - r_5))
sprintf("Match 6: r = %f, c = %f, d = %f", r_6, c_6, as.numeric(1 - r_6))
tokens_mod_test <- tokenize_ngrams(test4, n = 3)
tokens_mod_test <- data.frame(tokens_mod_test)
colnames(tokens_mod_test)[1] = "shingle"
for(i in 1:nrow(tokens_mod_test)){
line <- as.character(tokens_mod_test$shingle[i])
line <- unlist(strsplit(line, " "))
tokens_mod_test$sorted[i] <- paste(sort(line), collapse = " ")
}
tokens_mod_test <- select(tokens_mod_test, sorted)
tokens_mod_test <- distinct(tokens_mod_test)
for(i in 1:nrow(tokens_mod_test)){
tokens_mod_test$control_sum[i] <- digest(as.character(tokens_mod_test$sorted[i]), "md5", serialize = FALSE)
}
union1_mod <- union(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
intersect1_mod <- intersect(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
union1_mod <- length(union1_mod)
intersect1_mod <- length(intersect1_mod)
r_1_mod <- as.numeric(intersect1_mod / union1_mod)
c_1_mod <- as.numeric(intersect1_mod / nrow(tokens_mod_test))
union2_mod <- union(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
intersect2_mod <- intersect(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
union2_mod <- length(union2_mod)
intersect2_mod <- length(intersect2_mod)
r_2_mod <- as.numeric(intersect2_mod / union2_mod)
c_2_mod <- as.numeric(intersect2_mod / nrow(tokens_mod_test))
union3_mod <- union(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
intersect3_mod <- intersect(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
union3_mod <- length(union3_mod)
intersect3_mod <- length(intersect3_mod)
r_3_mod <- as.numeric(intersect3_mod / union3_mod)
c_3_mod <- as.numeric(intersect3_mod / nrow(tokens_mod_test))
union4_mod <- union(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
intersect4_mod <- intersect(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
union4_mod <- length(union4_mod)
intersect4_mod <- length(intersect4_mod)
r_4_mod <- as.numeric(intersect4_mod / union4_mod)
c_4_mod <- as.numeric(intersect4_mod / nrow(tokens_mod_test))
union5_mod <- union(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
intersect5_mod <- intersect(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
union5_mod <- length(union5_mod)
intersect5_mod <- length(intersect5_mod)
r_5_mod <- as.numeric(intersect5_mod / union5_mod)
c_5_mod <- as.numeric(intersect5_mod / nrow(tokens_mod_test))
union6_mod <- union(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
intersect6_mod <- intersect(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
union6_mod <- length(union6_mod)
intersect6_mod <- length(intersect6_mod)
r_6_mod <- as.numeric(intersect6_mod / union6_mod)
c_6_mod <- as.numeric(intersect6_mod / nrow(tokens_mod_test))
sprintf("Match 1 (modified): r = %f, c = %f, d = %f", r_1_mod, c_1_mod, as.numeric(1 - r_1_mod))
sprintf("Match 2 (modified): r = %f, c = %f, d = %f", r_2_mod, c_2_mod, as.numeric(1 - r_2_mod))
sprintf("Match 3 (modified): r = %f, c = %f, d = %f", r_3_mod, c_3_mod, as.numeric(1 - r_3_mod))
sprintf("Match 4 (modified): r = %f, c = %f, d = %f", r_4_mod, c_4_mod, as.numeric(1 - r_4_mod))
sprintf("Match 5 (modified): r = %f, c = %f, d = %f", r_5_mod, c_5_mod, as.numeric(1 - r_5_mod))
sprintf("Match 6 (modified): r = %f, c = %f, d = %f", r_6_mod, c_6_mod, as.numeric(1 - r_6_mod))
tokens_test <- tokenize_ngrams(test5, n = 3)
tokens_test <- data.frame(tokens_test)
tokens_test <- distinct(tokens_test)
colnames(tokens_test)[1] = "shingle"
for(i in 1:nrow(tokens_test)){
tokens_test$control_sum[i] <- digest(as.character(tokens_test$shingle[i]), "md5", serialize = FALSE)
}
union1 <- union(x = tokens1$control_sum, y = tokens_test$control_sum)
intersect1 <- intersect(x = tokens1$control_sum, y = tokens_test$control_sum)
union1 <- length(union1)
intersect1 <- length(intersect1)
r_1 <- as.numeric(intersect1 / union1)
c_1 <- as.numeric(intersect1 / nrow(tokens_test))
union2 <- union(x = tokens2$control_sum, y = tokens_test$control_sum)
intersect2 <- intersect(x = tokens2$control_sum, y = tokens_test$control_sum)
union2 <- length(union2)
intersect2 <- length(intersect2)
r_2 <- as.numeric(intersect2 / union2)
c_2 <- as.numeric(intersect2 / nrow(tokens_test))
union3 <- union(x = tokens3$control_sum, y = tokens_test$control_sum)
intersect3 <- intersect(x = tokens3$control_sum, y = tokens_test$control_sum)
union3 <- length(union3)
intersect3 <- length(intersect3)
r_3 <- as.numeric(intersect3 / union3)
c_3 <- as.numeric(intersect3 / nrow(tokens_test))
union4 <- union(x = tokens4$control_sum, y = tokens_test$control_sum)
intersect4 <- intersect(x = tokens4$control_sum, y = tokens_test$control_sum)
union4 <- length(union4)
intersect4 <- length(intersect4)
r_4 <- as.numeric(intersect4 / union4)
c_4 <- as.numeric(intersect4 / nrow(tokens_test))
union5 <- union(x = tokens5$control_sum, y = tokens_test$control_sum)
intersect5 <- intersect(x = tokens5$control_sum, y = tokens_test$control_sum)
union5 <- length(union5)
intersect5 <- length(intersect5)
r_5 <- as.numeric(intersect5 / union5)
c_5 <- as.numeric(intersect5 / nrow(tokens_test))
union6 <- union(x = tokens6$control_sum, y = tokens_test$control_sum)
intersect6 <- intersect(x = tokens6$control_sum, y = tokens_test$control_sum)
union6 <- length(union6)
intersect6 <- length(intersect6)
r_6 <- as.numeric(intersect6 / union6)
c_6 <- as.numeric(intersect6 / nrow(tokens_test))
sprintf("Match 1: r = %f, c = %f, d = %f", r_1, c_1, as.numeric(1 - r_1))
sprintf("Match 2: r = %f, c = %f, d = %f", r_2, c_2, as.numeric(1 - r_2))
sprintf("Match 3: r = %f, c = %f, d = %f", r_3, c_3, as.numeric(1 - r_3))
sprintf("Match 4: r = %f, c = %f, d = %f", r_4, c_4, as.numeric(1 - r_4))
sprintf("Match 5: r = %f, c = %f, d = %f", r_5, c_5, as.numeric(1 - r_5))
sprintf("Match 6: r = %f, c = %f, d = %f", r_6, c_6, as.numeric(1 - r_6))
tokens_mod_test <- tokenize_ngrams(test5, n = 3)
tokens_mod_test <- data.frame(tokens_mod_test)
colnames(tokens_mod_test)[1] = "shingle"
for(i in 1:nrow(tokens_mod_test)){
line <- as.character(tokens_mod_test$shingle[i])
line <- unlist(strsplit(line, " "))
tokens_mod_test$sorted[i] <- paste(sort(line), collapse = " ")
}
tokens_mod_test <- select(tokens_mod_test, sorted)
tokens_mod_test <- distinct(tokens_mod_test)
for(i in 1:nrow(tokens_mod_test)){
tokens_mod_test$control_sum[i] <- digest(as.character(tokens_mod_test$sorted[i]), "md5", serialize = FALSE)
}
union1_mod <- union(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
intersect1_mod <- intersect(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
union1_mod <- length(union1_mod)
intersect1_mod <- length(intersect1_mod)
r_1_mod <- as.numeric(intersect1_mod / union1_mod)
c_1_mod <- as.numeric(intersect1_mod / nrow(tokens_mod_test))
union2_mod <- union(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
intersect2_mod <- intersect(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
union2_mod <- length(union2_mod)
intersect2_mod <- length(intersect2_mod)
r_2_mod <- as.numeric(intersect2_mod / union2_mod)
c_2_mod <- as.numeric(intersect2_mod / nrow(tokens_mod_test))
union3_mod <- union(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
intersect3_mod <- intersect(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
union3_mod <- length(union3_mod)
intersect3_mod <- length(intersect3_mod)
r_3_mod <- as.numeric(intersect3_mod / union3_mod)
c_3_mod <- as.numeric(intersect3_mod / nrow(tokens_mod_test))
union4_mod <- union(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
intersect4_mod <- intersect(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
union4_mod <- length(union4_mod)
intersect4_mod <- length(intersect4_mod)
r_4_mod <- as.numeric(intersect4_mod / union4_mod)
c_4_mod <- as.numeric(intersect4_mod / nrow(tokens_mod_test))
union5_mod <- union(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
intersect5_mod <- intersect(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
union5_mod <- length(union5_mod)
intersect5_mod <- length(intersect5_mod)
r_5_mod <- as.numeric(intersect5_mod / union5_mod)
c_5_mod <- as.numeric(intersect5_mod / nrow(tokens_mod_test))
union6_mod <- union(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
intersect6_mod <- intersect(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
union6_mod <- length(union6_mod)
intersect6_mod <- length(intersect6_mod)
r_6_mod <- as.numeric(intersect6_mod / union6_mod)
c_6_mod <- as.numeric(intersect6_mod / nrow(tokens_mod_test))
sprintf("Match 1 (modified): r = %f, c = %f, d = %f", r_1_mod, c_1_mod, as.numeric(1 - r_1_mod))
sprintf("Match 2 (modified): r = %f, c = %f, d = %f", r_2_mod, c_2_mod, as.numeric(1 - r_2_mod))
sprintf("Match 3 (modified): r = %f, c = %f, d = %f", r_3_mod, c_3_mod, as.numeric(1 - r_3_mod))
sprintf("Match 4 (modified): r = %f, c = %f, d = %f", r_4_mod, c_4_mod, as.numeric(1 - r_4_mod))
sprintf("Match 5 (modified): r = %f, c = %f, d = %f", r_5_mod, c_5_mod, as.numeric(1 - r_5_mod))
sprintf("Match 6 (modified): r = %f, c = %f, d = %f", r_6_mod, c_6_mod, as.numeric(1 - r_6_mod))
tokens_test <- tokenize_ngrams(test6, n = 3)
tokens_test <- data.frame(tokens_test)
tokens_test <- distinct(tokens_test)
colnames(tokens_test)[1] = "shingle"
for(i in 1:nrow(tokens_test)){
tokens_test$control_sum[i] <- digest(as.character(tokens_test$shingle[i]), "md5", serialize = FALSE)
}
union1 <- union(x = tokens1$control_sum, y = tokens_test$control_sum)
intersect1 <- intersect(x = tokens1$control_sum, y = tokens_test$control_sum)
union1 <- length(union1)
intersect1 <- length(intersect1)
r_1 <- as.numeric(intersect1 / union1)
c_1 <- as.numeric(intersect1 / nrow(tokens_test))
union2 <- union(x = tokens2$control_sum, y = tokens_test$control_sum)
intersect2 <- intersect(x = tokens2$control_sum, y = tokens_test$control_sum)
union2 <- length(union2)
intersect2 <- length(intersect2)
r_2 <- as.numeric(intersect2 / union2)
c_2 <- as.numeric(intersect2 / nrow(tokens_test))
union3 <- union(x = tokens3$control_sum, y = tokens_test$control_sum)
intersect3 <- intersect(x = tokens3$control_sum, y = tokens_test$control_sum)
union3 <- length(union3)
intersect3 <- length(intersect3)
r_3 <- as.numeric(intersect3 / union3)
c_3 <- as.numeric(intersect3 / nrow(tokens_test))
union4 <- union(x = tokens4$control_sum, y = tokens_test$control_sum)
intersect4 <- intersect(x = tokens4$control_sum, y = tokens_test$control_sum)
union4 <- length(union4)
intersect4 <- length(intersect4)
r_4 <- as.numeric(intersect4 / union4)
c_4 <- as.numeric(intersect4 / nrow(tokens_test))
union5 <- union(x = tokens5$control_sum, y = tokens_test$control_sum)
intersect5 <- intersect(x = tokens5$control_sum, y = tokens_test$control_sum)
union5 <- length(union5)
intersect5 <- length(intersect5)
r_5 <- as.numeric(intersect5 / union5)
c_5 <- as.numeric(intersect5 / nrow(tokens_test))
union6 <- union(x = tokens6$control_sum, y = tokens_test$control_sum)
intersect6 <- intersect(x = tokens6$control_sum, y = tokens_test$control_sum)
union6 <- length(union6)
intersect6 <- length(intersect6)
r_6 <- as.numeric(intersect6 / union6)
c_6 <- as.numeric(intersect6 / nrow(tokens_test))
sprintf("Match 1: r = %f, c = %f, d = %f", r_1, c_1, as.numeric(1 - r_1))
sprintf("Match 2: r = %f, c = %f, d = %f", r_2, c_2, as.numeric(1 - r_2))
sprintf("Match 3: r = %f, c = %f, d = %f", r_3, c_3, as.numeric(1 - r_3))
sprintf("Match 4: r = %f, c = %f, d = %f", r_4, c_4, as.numeric(1 - r_4))
sprintf("Match 5: r = %f, c = %f, d = %f", r_5, c_5, as.numeric(1 - r_5))
sprintf("Match 6: r = %f, c = %f, d = %f", r_6, c_6, as.numeric(1 - r_6))
tokens_mod_test <- tokenize_ngrams(test6, n = 3)
tokens_mod_test <- data.frame(tokens_mod_test)
colnames(tokens_mod_test)[1] = "shingle"
for(i in 1:nrow(tokens_mod_test)){
line <- as.character(tokens_mod_test$shingle[i])
line <- unlist(strsplit(line, " "))
tokens_mod_test$sorted[i] <- paste(sort(line), collapse = " ")
}
tokens_mod_test <- select(tokens_mod_test, sorted)
tokens_mod_test <- distinct(tokens_mod_test)
for(i in 1:nrow(tokens_mod_test)){
tokens_mod_test$control_sum[i] <- digest(as.character(tokens_mod_test$sorted[i]), "md5", serialize = FALSE)
}
union1_mod <- union(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
intersect1_mod <- intersect(x = tokens1_mod$control_sum, y = tokens_mod_test$control_sum)
union1_mod <- length(union1_mod)
intersect1_mod <- length(intersect1_mod)
r_1_mod <- as.numeric(intersect1_mod / union1_mod)
c_1_mod <- as.numeric(intersect1_mod / nrow(tokens_mod_test))
union2_mod <- union(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
intersect2_mod <- intersect(x = tokens2_mod$control_sum, y = tokens_mod_test$control_sum)
union2_mod <- length(union2_mod)
intersect2_mod <- length(intersect2_mod)
r_2_mod <- as.numeric(intersect2_mod / union2_mod)
c_2_mod <- as.numeric(intersect2_mod / nrow(tokens_mod_test))
union3_mod <- union(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
intersect3_mod <- intersect(x = tokens3_mod$control_sum, y = tokens_mod_test$control_sum)
union3_mod <- length(union3_mod)
intersect3_mod <- length(intersect3_mod)
r_3_mod <- as.numeric(intersect3_mod / union3_mod)
c_3_mod <- as.numeric(intersect3_mod / nrow(tokens_mod_test))
union4_mod <- union(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
intersect4_mod <- intersect(x = tokens4_mod$control_sum, y = tokens_mod_test$control_sum)
union4_mod <- length(union4_mod)
intersect4_mod <- length(intersect4_mod)
r_4_mod <- as.numeric(intersect4_mod / union4_mod)
c_4_mod <- as.numeric(intersect4_mod / nrow(tokens_mod_test))
union5_mod <- union(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
intersect5_mod <- intersect(x = tokens5_mod$control_sum, y = tokens_mod_test$control_sum)
union5_mod <- length(union5_mod)
intersect5_mod <- length(intersect5_mod)
r_5_mod <- as.numeric(intersect5_mod / union5_mod)
c_5_mod <- as.numeric(intersect5_mod / nrow(tokens_mod_test))
union6_mod <- union(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
intersect6_mod <- intersect(x = tokens6_mod$control_sum, y = tokens_mod_test$control_sum)
union6_mod <- length(union6_mod)
intersect6_mod <- length(intersect6_mod)
r_6_mod <- as.numeric(intersect6_mod / union6_mod)
c_6_mod <- as.numeric(intersect6_mod / nrow(tokens_mod_test))
sprintf("Match 1 (modified): r = %f, c = %f, d = %f", r_1_mod, c_1_mod, as.numeric(1 - r_1_mod))
sprintf("Match 2 (modified): r = %f, c = %f, d = %f", r_2_mod, c_2_mod, as.numeric(1 - r_2_mod))
sprintf("Match 3 (modified): r = %f, c = %f, d = %f", r_3_mod, c_3_mod, as.numeric(1 - r_3_mod))
sprintf("Match 4 (modified): r = %f, c = %f, d = %f", r_4_mod, c_4_mod, as.numeric(1 - r_4_mod))
sprintf("Match 5 (modified): r = %f, c = %f, d = %f", r_5_mod, c_5_mod, as.numeric(1 - r_5_mod))
sprintf("Match 6 (modified): r = %f, c = %f, d = %f", r_6_mod, c_6_mod, as.numeric(1 - r_6_mod))
rm(text1, text2, text3, text4, text5, text6)
rm(tokens1, tokens_mod_test, tokens_test, tokens1_mod, tokens2, tokens2_mod, tokens3, tokens3_mod,
tokens4, tokens4_mod, tokens5, tokens5_mod, tokens6, tokens6_mod, s1, s2, symbols)
rm(test1, test2, test3, test4, test5, test6)
rm(un, int)
